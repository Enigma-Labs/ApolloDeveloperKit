<!DOCTYPE html>
<html lang="en">
  <head>
    <title>ApolloDeveloperKit  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="ApolloDeveloperKit  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">ApolloDeveloperKit Docs</a> (46% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">ApolloDeveloperKit Reference</a>
        <img id="carat" src="img/carat.png" />
        ApolloDeveloperKit  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/ApolloDebugServer.html">ApolloDebugServer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DebuggableNetworkTransport.html">DebuggableNetworkTransport</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DebuggableNormalizedCache.html">DebuggableNormalizedCache</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/HTTPServerError.html">HTTPServerError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/Record.html">Record</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Reference.html">Reference</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='apollodeveloperkit' class='heading'>ApolloDeveloperKit</h1>

<p><a href="https://travis-ci.org/manicmaniac/ApolloDeveloperKit"><img src="https://travis-ci.org/manicmaniac/ApolloDeveloperKit.svg?branch=master" alt="Build Status"></a>
<a href="https://codeclimate.com/github/manicmaniac/ApolloDeveloperKit/maintainability"><img src="https://api.codeclimate.com/v1/badges/c45fc7657ce194edee35/maintainability" alt="Maintainability"></a>
<a href="https://cocoapods.org/pods/ApolloDeveloperKit"><img src="https://img.shields.io/cocoapods/v/ApolloDeveloperKit.svg" alt="CocoaPods Compatible"></a>
<a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage Compatible"></a>
<a href="https://manicmaniac.github.io/ApolloDeveloperKit/"><img src="https://img.shields.io/cocoapods/p/ApolloDeveloperKit.svg?style=flat" alt="Platform"></a></p>

<p><a href="https://github.com/apollographql/apollo-client-devtools">Apollo Client Devtools</a> bridge for <a href="https://github.com/apollographql/apollo-ios">Apollo iOS</a>.</p>
<h2 id='overview' class='heading'>Overview</h2>

<p>ApolloDeveloperKit is an iOS / macOS library which works as a bridge between Apollo iOS client and <a href="https://chrome.google.com/webstore/detail/apollo-client-developer-t/jdkknkkbebbapilgoeccciglkfbmbnfm">Apollo Client Developer tools</a>.</p>

<p>This library adds an ability to watch the sent queries or mutations simultaneously, and also has the feature to request arbitrary operations from embedded GraphiQL console.</p>
<h2 id='screenshots' class='heading'>Screenshots</h2>

<p><img width="1332" alt="apollo-developer-kit-animation" src="https://user-images.githubusercontent.com/1672393/62706435-0db01580-b9df-11e9-9033-cb8055074b91.gif"></p>
<h2 id='prerequisites' class='heading'>Prerequisites</h2>

<ul>
<li>Xcode <code>&gt;= 10.1</code></li>
<li>Google Chrome</li>
<li><a href="https://github.com/apollographql/apollo-ios">Apollo iOS</a> <code>&gt;= 0.9.1</code>, <code>&lt; 0.20.0</code></li>
<li><a href="https://github.com/apollographql/apollo-client-devtools">Apollo Client Devtools</a></li>
</ul>
<h2 id='installation' class='heading'>Installation</h2>
<h3 id='install-from-cocoapods' class='heading'>Install from CocoaPods</h3>

<p>Add the following lines to your Podfile.</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'Apollo'</span>
<span class="n">pod</span> <span class="s1">'ApolloDeveloperKit'</span><span class="p">,</span> <span class="s1">'~&gt; 0.7.0'</span>
</code></pre>

<p>Then run <code>pod install</code>.</p>
<h3 id='install-from-carthage' class='heading'>Install from Carthage</h3>

<p>Add the following lines to your Cartfile.</p>
<pre class="highlight plaintext"><code>github "apollographql/apollo-ios"
github "manicmaniac/ApolloDeveloperKit"
</code></pre>

<p>Then run <code>carthage update --platform iOS</code> or <code>carthage update --platform Mac</code>.</p>
<h4 id='for-xcode-10-1-swift-4-2' class='heading'>For Xcode 10.1 (Swift 4.2)</h4>

<p>If you are using Xcode 10.1, where Swift 5 is not available, the install step could be a bit tricky though Cartfile can be as it is.
Contrary to CocoaPods, Carthage doesn&rsquo;t select the compiler by itself so the only way to force it to use Swift 4.2 is to inject a Xcode configuration file.</p>
<pre class="highlight shell"><code><span class="nb">echo </span><span class="nv">APOLLO_DEVELOPER_KIT_SWIFT_VERSION</span><span class="o">=</span>4.2 &gt;ApolloDeveloperKit.xcconfig
<span class="nv">XCODE_XCCONFIG_FILE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$PWD</span><span class="s2">/ApolloDeveloperKit.xcconfig"</span> carthage update --platform iOS
rm ApolloDeveloperKit.xcconfig
</code></pre>

<p>Note <code>XCODE_XCCONFIG_FILE</code> should be an absolute path somehow.</p>

<p>Not recommended but as plan B, you can use <code>ApolloDeveloperKit ~&gt; 0.3.3</code> which only supports Swift 4.2 as well.</p>
<h2 id='setup' class='heading'>Setup</h2>

<p>First, in order to hook Apollo&rsquo;s cache and network layer, you need to use <code><a href="Classes/DebuggableNetworkTransport.html">DebuggableNetworkTransport</a></code> and <code>DebuggableInMemoryNormalizedCache</code> instead of usual ones.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">networkTransport</span> <span class="o">=</span> <span class="kt">DebuggableNetworkTransport</span><span class="p">(</span><span class="nv">networkTransport</span><span class="p">:</span> <span class="kt">HTTPNetworkTransport</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">))</span>
<span class="k">let</span> <span class="nv">cache</span> <span class="o">=</span> <span class="kt">DebuggableInMemoryNormalizedCache</span><span class="p">()</span>
</code></pre>

<p>Second, instantiate <code>ApolloStore</code> and <code>ApolloClient</code> with debuggable ingredients.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">ApolloStore</span><span class="p">(</span><span class="nv">cache</span><span class="p">:</span> <span class="n">cache</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">client</span> <span class="o">=</span> <span class="kt">ApolloClient</span><span class="p">(</span><span class="nv">networkTransport</span><span class="p">:</span> <span class="nv">networkTransport</span><span class="p">:</span> <span class="nv">store</span><span class="p">:</span> <span class="n">store</span><span class="p">)</span>
</code></pre>

<p>Finally, create <code><a href="Classes/ApolloDebugServer.html">ApolloDebugServer</a></code> and run.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">debugServer</span> <span class="o">=</span> <span class="kt">ApolloDebugServer</span><span class="p">(</span><span class="nv">cache</span><span class="p">:</span> <span class="n">cache</span><span class="p">,</span> <span class="nv">networkTransport</span><span class="p">:</span> <span class="n">networkTransport</span><span class="p">)</span>
<span class="k">self</span><span class="o">.</span><span class="n">debugServer</span> <span class="o">=</span> <span class="n">debugServer</span> <span class="c1">// Note: you need to retain debugServer's reference</span>
<span class="n">debugServer</span><span class="o">.</span><span class="nf">start</span><span class="p">(</span><span class="nv">port</span><span class="p">:</span> <span class="mi">8081</span><span class="p">)</span>
</code></pre>

<p>Full example:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Apollo</span>
<span class="kd">import</span> <span class="kt">ApolloDeveloperKit</span>
<span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">@UIApplicationMain</span>
<span class="kd">class</span> <span class="kt">AppDelegate</span><span class="p">:</span> <span class="kt">UIResponder</span><span class="p">,</span> <span class="kt">UIApplicationDelegate</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">window</span><span class="p">:</span> <span class="kt">UIWindow</span><span class="p">?</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">client</span><span class="p">:</span> <span class="kt">ApolloClient</span><span class="o">!</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">debugServer</span><span class="p">:</span> <span class="kt">ApolloDebugServer</span><span class="p">?</span>

    <span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplication</span><span class="o">.</span><span class="kt">LaunchOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">url</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://example.com/graphql"</span><span class="p">)</span><span class="o">!</span>
        <span class="cp">#if DEBUG</span>
            <span class="k">let</span> <span class="nv">networkTransport</span> <span class="o">=</span> <span class="kt">DebuggableNetworkTransport</span><span class="p">(</span><span class="nv">networkTransport</span><span class="p">:</span> <span class="kt">HTTPNetworkTransport</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">))</span>
            <span class="k">let</span> <span class="nv">cache</span> <span class="o">=</span> <span class="kt">DebuggableNormalizedCache</span><span class="p">(</span><span class="nv">cache</span><span class="p">:</span> <span class="kt">InMemoryNormalizedCache</span><span class="p">())</span>
            <span class="k">let</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">ApolloStore</span><span class="p">(</span><span class="nv">cache</span><span class="p">:</span> <span class="n">cache</span><span class="p">)</span>
            <span class="n">client</span> <span class="o">=</span> <span class="kt">ApolloClient</span><span class="p">(</span><span class="nv">networkTransport</span><span class="p">:</span> <span class="n">networkTransport</span><span class="p">,</span> <span class="nv">store</span><span class="p">:</span> <span class="n">store</span><span class="p">)</span>
            <span class="n">debugServer</span> <span class="o">=</span> <span class="kt">ApolloDebugServer</span><span class="p">(</span><span class="nv">networkTransport</span><span class="p">:</span> <span class="n">networkTransport</span><span class="p">,</span> <span class="nv">cache</span><span class="p">:</span> <span class="n">cache</span><span class="p">)</span>
            <span class="k">do</span> <span class="p">{</span>
                <span class="k">try</span> <span class="n">debugServer</span><span class="o">.</span><span class="nf">start</span><span class="p">(</span><span class="nv">port</span><span class="p">:</span> <span class="mi">8081</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">error</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="cp">#else</span>
            <span class="n">client</span> <span class="o">=</span> <span class="kt">ApolloClient</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>
        <span class="cp">#endif</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='usage' class='heading'>Usage</h2>

<p><strong>If you don&rsquo;t have <a href="https://www.google.com/chrome">Google Chrome</a> and <a href="https://chrome.google.com/webstore/detail/apollo-client-developer-t/jdkknkkbebbapilgoeccciglkfbmbnfm">Apollo Client Developer Tools</a>, install them before proceeding the following steps.</strong></p>

<ol>
<li>Launch your app on your device or simulator.</li>
<li>Open Google Chrome and jump to the server&rsquo;s URL (in case your app runs the above example on a simulator, the URL would be <code>http://localhost:8081</code>).

<ul>
<li>You will see <code>ApolloDebugServer is running!</code> on your browser&rsquo;s tab.</li>
<li>If not, make sure the server runs and the specified URL is correct.</li>
<li>On a real device, the host would be other than <code>localhost</code> but you can check what it is with <code><a href="Classes/ApolloDebugServer.html#/s:18ApolloDeveloperKit0A11DebugServerC9serverURL10Foundation0G0VSgvp">ApolloDebugServer.serverURL</a></code>.</li>
</ul></li>
<li>Open <a href="https://developers.google.com/web/tools/chrome-devtools/open">Google Chrome DevTools</a>.</li>
<li>Select <code>Apollo</code> tab.

<ul>
<li>You will see tabs like <code>GraphiQL</code>, <code>Queries</code>, <code>Mutations</code> on the left pane.</li>
<li>If not, reload the tab and wait until it&rsquo;s connected again.</li>
</ul></li>
</ol>
<h2 id='excluding-apollodeveloperkit-from-release-app-store-builds' class='heading'>Excluding ApolloDeveloperKit from Release (App Store) Builds</h2>

<p>All instructions in this section are written based on <a href="https://github.com/Flipboard/FLEX">Flipboard/FLEX</a>&rsquo;s way.</p>

<p>Since ApolloDeveloperKit is originally designed for debug use only, it should not be exposed to end-users.</p>

<p>Fortunately, it is easy to exclude ApolloDeveloperKit framework from Release builds. The strategies differ depending on how you integrated it in your project, and are described below.</p>

<p>Please make sure your code is properly excluding ApolloDeveloperKit with <code>#if DEBUG</code> statements before starting these instructions.
Otherwise it will be linked to your app unexpectedly.
See <code>Example/AppDelegate.swift</code> to see how to do it.</p>
<h3 id='for-cocoapods-users' class='heading'>For CocoaPods users</h3>

<p>CocoaPods automatically excludes ApolloDeveloperKit from release builds if you only specify the Debug configuration for CocoaPods in your Podfile.</p>
<h3 id='for-carthage-users' class='heading'>For Carthage users</h3>

<ol>
<li>Do NOT add <code>ApolloDeveloperKit.framework</code> to the embedded binaries of your target, as it would otherwise be included in all builds (therefore also in release ones).</li>
<li>Instead, add <code>$(PROJECT_DIR)/Carthage/Build/iOS</code> or <code>$(PROJECT_DIR)/Carthage/Build/Mac</code> to your target <em>Framework Search Paths</em> (this setting might already be present if you already included other frameworks with Carthage).
This makes it possible to import the ApolloDeveloperKit framework from your source files. It does not harm if this setting is added for all configurations, but it should at least be added for the debug one.</li>
<li>Add a <em>Run Script Phase</em> to your target (inserting it alter the existing <code>Link Binary with Libraries</code> phase, for example), and which will embed <code>ApolloDeveloperKit.framework</code> in debug builds only:</li>
</ol>
<pre class="highlight shell"><code><span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$CONFIGURATION</span><span class="s2">"</span> <span class="o">=</span> Debug <span class="o">]</span>; <span class="k">then</span>
  /usr/local/bin/carthage copy-frameworks
<span class="k">fi</span>
</code></pre>

<p>Finally, add <code>$(SRCROOT)/Carthage/Build/iOS/ApolloDeveloperKit.framework</code> or <code>$(SRCROOT)/Carthage/Build/Mac/ApolloDeveloperKit.framework</code> as input file of this script phase.</p>
<h3 id='for-users-those-who-copy-all-the-source-files-to-the-project-manually' class='heading'>For users those who copy all the source files to the project manually</h3>

<p>Now there&rsquo;s no easy way but you can exclude ApolloDeveloperKit by setting user defined build variable named <code>EXCLUDED_SOURCE_FILE_NAMES</code>.
The value for the variable is a space-separated list of each filenames in ApolloDeveloperKit.
Sorry for the inconvenience.</p>
<h2 id='console-redirection' class='heading'>Console Redirection</h2>

<p><code>ApolloDeveloperKit</code> supports console redirection.
When it is enabled, all logs written in stdout (usually written with <code>print()</code>) and stderr (written with <code>NSLog()</code>) are redirected to the web browser&rsquo;s console as well.</p>

<p>This feature is disabled by default so you may want to enable it explicitly.</p>
<pre class="highlight swift"><code><span class="n">debugServer</span> <span class="o">=</span> <span class="kt">ApolloDebugServer</span><span class="p">(</span><span class="nv">networkTransport</span><span class="p">:</span> <span class="n">networkTransport</span><span class="p">,</span> <span class="nv">cache</span><span class="p">:</span> <span class="n">cache</span><span class="p">)</span>
<span class="n">debugServer</span><span class="o">.</span><span class="n">enableConsoleRedirection</span> <span class="o">=</span> <span class="kc">true</span>
</code></pre>

<p>Then open the console in Google Chrome Devtools.
You will see logs in your iPhone or simulator.</p>

<p>In the browser console, logs written in stdout are colored in <a href="https://www.color-hex.com/color/5f9ea0">blue-green</a> and stderr are <a href="https://www.color-hex.com/color/ff6347">orange</a> so that you can distinguish them from ordinary browser logs.</p>

<p><img width="1440" alt="console-redirection.png" src="https://user-images.githubusercontent.com/1672393/68502106-07ae2700-02a3-11ea-8d35-02f1280ea625.png"></p>
<h2 id='development' class='heading'>Development</h2>
<h3 id='api-documentation' class='heading'>API Documentation</h3>

<p>Auto-generated API documentation is <a href="https://manicmaniac.github.io/ApolloDeveloperKit">here</a>.</p>
<h3 id='run-example-app' class='heading'>Run Example App</h3>

<p>Since Example app is slightly modified version of <a href="https://github.com/apollographql/frontpage-ios-app">apollographql/frontpage-ios-app</a>,
you need to start <a href="https://github.com/apollographql/frontpage-server">apollographql/frontpage-server</a> before runnning the app.</p>

<ol>
<li>Open Xcode and select ApolloDeveloperKitExample scheme.</li>
<li>Run and open <code>http://localhost:8081</code> in Google Chrome.</li>
</ol>
<h2 id='license' class='heading'>License</h2>

<p>This software is distributed under the MIT license.
See LICENSE for more detail.</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2019 <a class="link" href="https://github.com/manicmaniac/ApolloDeveloperKit" target="_blank" rel="external">Ryosuke Ito</a>. All rights reserved. (Last updated: 2019-11-15)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.11.1</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
